# Война Вирусов

Война Вирусов — игра, в которую играют два игрока на поле 10 на 10.
Цель игры — захватить как можно больше клеток, устанавливая новые свои клетки или уничтожая клетки соперника.
В рамках этого проекта будет реализовано приложение для игры в Войну Вирусов по сети против другого игрока,
а также, возможно, офлайн-игра против бота.

Приложение будет состоять из серверной и клиентской части, сообщающихся через [Google Cloud Messaging](https://developers.google.com/cloud-messaging/).
Серверная часть отвечает за хранение всех данных, в том числе текущих игр, и пересылку ходов игрокам.
Клиентская часть предлогает игроку войти, настраивать свой аккаунт, выбрать противника для игры и, собственно, играть.

# Данные

Необходимо хранить в базе данных следующее:

## Игрок

Сущность, описывающая игрока.

1. Авторизация через аккаунт Google/Google Play/... — необходимо хранить некоторый индетификатор.
1. Ник
1. Цвет (условно некторые дополнительные настройки аккаунта)
1. Статус приглашения. За час сбрасывается.
1. Последний момент онлайна (последнего уведомления)

## Девайсы

Отображение один пользователь — многие индетификаторы его устройств.
Используются для рассылки уведомлений.

## Контакты

Отобржаение один пользователь — многие пользователи, которые добавлены в контакты.
Это отображение не обязательно симметричное.

## Сохранённые игры

1. Номер игры
1. Игроки (крестики и нолики)
1. Результат (кто победил)

## Ходы

Отображение номер игры и номер хожа — ход.
Хранит действия игроков для последующего просмотра, статистики и прочего.

# Сервер

1. Подключается к GCM
1. Хранит состояния открытых игр.

# Протокол

1. Авторизация
	1. Проверка логина-пароля/аккаунта.
		Если авторизация через Google, видимо эта часть делается за нас через Google API.
	1. Новый аккаунт

1. Информация о аккаунте
    1. Общие настройки
    1. Список друзей

1. Пригласить в игру
1. Ответ на приглашение

1. Игра
    1. Ходики, в том числе пропуск хода
    1. Сдаться

1. Месседж?

# Клиент

## Activity:

1. Main (список друзей, переходы настройки, список игр и так далее).
	Если вход выполнен — проверить состояние.
	При запуске — если есть открытая игра, СРАЗУ туда.
	Отобрает список друзей (и онлайн ли они).
	При нажатии отображает аккаунт игрока.
	Наверху всегда есть "Play vs bot".
	Если выполнен вход, также пишет список друзей.
	Если не выполнен — предлагает войти.
	Шторка — оттуда на свой аккаунт, выйти, настройки.

1. Settings — панель настроек. Выход из аккаунта, ник, цвет, звук, уведомления.

1. Game — отображать уже прошедшие игры и текущую.
	Получает, что делать (воспроизведение уже прошедшей игры, запуск игры с заданным противником).
    Отображает заголовок с никами, кто за кого играет.
    Также в центре игровое поле 10*10, при игре нажимать для хода.
    Поле также отображает возможные клетки для хода.
    При отображении сохранённой игры отображаются кнопки перемотки:
    вперёд, назад, то же самое до конца, посередине число ходов и номер текущего хода.

1. Аккаунт игрока.
    Отображает общую информацию об игроке (ник, цвет, статистика, онлайн ли).
    Также отображает список сохранённых игр (открывает сохранённую игру),
    кнопка играть (для себя не отображается).

# Код

## Классы протокола

1. Строки — заголовки сообщений
1. Диспатчеры, обрабатывающие сообщения (как клиентский, так и серверный)
1. Инициализация-деинициализация GCM
1. Генерация уведомлений (клиент).

## Класс игры
Так храним открытые игры (не завершённые на сервере, а также всё, что отображается на клиенте).
Сохранённые, закрытые игры хранятся в базе данных.

1. Поле
1. Определение, кто ходит
1. Предоставление корректных для хода клеток
1. Проверка ходов
1. Проверка окончания игры
1. Прочая игровая логика
	
## Интерфейс участника игры.
Отвественнен за обработку хода одного из игроков.

### Пользователь
Предлагает пользователю походить на Activity.

### Противник-игрок
Сообщает о ходе игрока по сети противнику, ждёт ответа.

### Противник-бот
Думает ходы локально перебором с отсечениями.
